<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Talha Full Proxy Stream</title>
<style>
  html,body{margin:0;padding:0;height:100%;background:#000}
  #container{position:relative;height:100vh;overflow:hidden}
  iframe{width:100%;height:100vh;border:0;display:block}
  .telegram-button{position:absolute;top:10px;left:10px;z-index:9999;cursor:pointer}
  .telegram-button img{width:60px;height:60px;border-radius:12px;box-shadow:0 4px 16px rgba(0,0,0,0.4)}
  .footer-text{position:absolute;bottom:10px;left:50%;transform:translateX(-50%);z-index:9998;color:#f33;background:rgba(0,0,0,0.4);padding:6px 12px;border-radius:6px;font-weight:600}
  .channel-buttons{position:absolute;top:10px;right:10px;z-index:9999;display:flex;gap:8px}
  .channel-buttons button{padding:8px 12px;border-radius:6px;border:none;background:#fff;color:#000;cursor:pointer}
</style>
</head>
<body>
<div id="container">
  <div class="telegram-button" onclick="window.open('https://t.me/talhasmovie_request_bot','_blank')">
    <img src="https://s1.gifyu.com/images/SAe3R.png" alt="tg">
  </div>

  <div class="channel-buttons">
    <button data-ch="astro-cricket">Astro</button>
    <button data-ch="willow">Willow</button>
    <button data-ch="ptv">PTV</button>
    <button data-ch="ten-cricket">TEN</button>
  </div>

  <iframe id="stream-iframe" sandbox="allow-scripts allow-same-origin" src="" allow="autoplay; encrypted-media; picture-in-picture; fullscreen" allowfullscreen></iframe>

  <div class="footer-text">Welcome to Talha's Full Proxy Stream â€” Clean player (no iframe block)</div>
</div>

<script>
const WORKER_BASE_URL = 'https://liveon.rajtammi111212.workers.dev/';
const DEFAULT_CHANNEL = 'astro-cricket';

function setChannel(ch){
  const iframe = document.getElementById('stream-iframe');
  iframe.src = WORKER_BASE_URL + '?ch=' + encodeURIComponent(ch) + '&_v=' + Date.now();
}

document.addEventListener('DOMContentLoaded', ()=>{
  setChannel(DEFAULT_CHANNEL);
  document.querySelectorAll('.channel-buttons button').forEach(btn=>{
    btn.addEventListener('click', ()=> setChannel(btn.getAttribute('data-ch')));
  });

  parentHijackBlocker();
});

// Parent-side Hijack/Ads Blocker
function parentHijackBlocker(){
  document.addEventListener('click', e=>{
    let el = e.target;
    while(el && el!==document){
      if(el.tagName==='A'){ 
        if(el.dataset.href||el.target==='blank'){ e.preventDefault(); e.stopPropagation(); return false; }
      }
      el=el.parentNode;
    }
  }, true);

  setInterval(()=>{
    document.querySelectorAll('[id*="ads"], [class*="ads"], [id*="banner"], [class*="banner"], .popup, .interstitial').forEach(n=>n.remove());
  }, 1500);

  const mo = new MutationObserver(muts=>{
    muts.forEach(m=>{
      if(m.addedNodes) m.addedNodes.forEach(n=>{
        if(n.nodeType===1){
          if(/ads|banner|overlay|popup|interstitial|sponsor/i.test((n.id||'') + (n.className||''))) n.remove();
        }
      });
    });
  });
  mo.observe(document.body,{childList:true,subtree:true});
}
</script>
</body>
</html>
